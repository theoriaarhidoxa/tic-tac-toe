(this.webpackJsonpfcc2=this.webpackJsonpfcc2||[]).push([[0],{13:function(e,t,c){},14:function(e,t,c){},15:function(e,t,c){},17:function(e,t,c){"use strict";c.r(t);var n=c(2),a=c(7),i=c.n(a),r=(c(13),c(8)),s=c(1),o=c(3),l=(c(14),c(15),c(0)),j=function(e){var t=e.data,c=e.onCancel,a=e.onSubmit,i=Object(n.useState)(Object(s.a)({},t)),r=Object(o.a)(i,2),j=r[0],u=r[1],d=Object(n.useState)(!1),b=Object(o.a)(d,2),h=b[0],O=b[1];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{className:"overlay",onClick:function(){c()}}),Object(l.jsx)("div",{className:"settings",children:Object(l.jsxs)("form",{className:"settings__form",onSubmit:function(e){e.preventDefault(),a(j),c()},children:[Object(l.jsxs)("div",{className:"settings__form-item",children:[Object(l.jsx)("label",{children:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f"}),Object(l.jsx)("input",{type:"text",className:j.name?"":"error",value:j.name,onChange:function(e){var t=e.target.value;O(!t.length),u(Object(s.a)(Object(s.a)({},j),{},{name:t}))}})]}),Object(l.jsxs)("div",{className:"settings__form-item",children:[Object(l.jsx)("label",{children:"\u0420\u0430\u0437\u043c\u0435\u0440\u044b \u043f\u043e\u043b\u044f"}),Object(l.jsx)("select",{value:j.width,onChange:function(e){return u(Object(s.a)(Object(s.a)({},j),{},{width:+e.target.value}))},children:[3,4,5].map((function(e){return Object(l.jsxs)("option",{value:e,children:[e,"x",e]},e)}))})]}),Object(l.jsxs)("div",{className:"settings__form-item",children:[Object(l.jsx)("label",{children:"\u041a\u0442\u043e \u043d\u0430\u0447\u043d\u0451\u0442?"}),Object(l.jsxs)("select",{value:j.starter,onChange:function(e){return u(Object(s.a)(Object(s.a)({},j),{},{starter:e.target.value}))},children:[Object(l.jsx)("option",{value:"user",children:j.name}),Object(l.jsx)("option",{value:"AI",children:"\u041a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440"})]})]}),Object(l.jsxs)("div",{className:"settings__form-item",children:[Object(l.jsx)("input",{type:"button",value:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c",onClick:function(){u({name:"Player1",width:3,starter:"user"})}}),Object(l.jsx)("input",{type:"submit",value:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",disabled:h})]})]})})]})},u=function(){var e=Object(n.useState)({name:localStorage.getItem("tttUserName")||"Player1",width:Number(localStorage.getItem("tttWidth"))||3,starter:localStorage.getItem("tttStarter")||"user",score:localStorage.getItem("tttScore")||"0:0"}),t=Object(o.a)(e,2),c=t[0],a=t[1],i=Object(n.useState)(!localStorage.getItem("tttUserName")),u=Object(o.a)(i,2),d=u[0],b=u[1],h=Object(n.useState)(c.width),O=Object(o.a)(h,1)[0],m=Object(n.useState)(!1),f=Object(o.a)(m,2),v=f[0],g=f[1],x=Object(n.useState)(new Array(Math.pow(O,2)).fill({disabled:!1,userChoice:!1,machineChoice:!1,animated:!1}).map((function(e,t){return Object(s.a)(Object(s.a)({},e),{},{id:t})}))),p=Object(o.a)(x,2),S=p[0],C=p[1],w=Object(n.useState)(""),N=Object(o.a)(w,2),_=N[0],k=N[1],I=Object(n.useState)(!1),y=Object(o.a)(I,2),E=y[0],A=y[1],M=Object(n.useState)(!1),T=Object(o.a)(M,2),U=T[0],W=T[1],F=c.score.split(":"),J=Object(o.a)(F,2),L=J[0],P=J[1],B=function(e){for(var t=[],c=[0],n=[e-1],a=0;a<e*e;){for(var i=[],r=1;r<=e;r++)i.push(a+r-1);t.push(i),a+=e}for(a=0;a<e;){for(var s=[],o=0;o<e*e;o+=e)s.push(a+o);t.push(s),a++}for(var l=0;l<e-1;l++)c.push(c[c.length-1]+e+1),n.push(n[n.length-1]+e-1);return t.push(c,n),t}(c.width),D=Object(n.useRef)(null);Object(n.useEffect)((function(){var e,t,c=(null===D||void 0===D||null===(e=D.current)||void 0===e?void 0:e.childNodes[0]).clientWidth;null===D||void 0===D||null===(t=D.current)||void 0===t||t.childNodes.forEach((function(e){e.style.height=c+"px"}))}),[]),Object(n.useEffect)((function(){("AI"===c.starter||S.filter((function(e){return!e.userChoice})).length<S.length)&&q()}),[S]),Object(n.useEffect)((function(){v&&setTimeout((function(){R()}),500)}),[v]);var R=function(){var e=S.filter((function(e){return!e.disabled})).map((function(e){return e.id})),t=e[Math.floor(Math.random()*e.length)];C(S.map((function(e){return e.id===t?Object(s.a)(Object(s.a)({},e),{},{machineChoice:!0,disabled:!0}):e}))),W(!1)},q=function(){for(var e=[],t=0;t<B.length;t++){if(B[t].map((function(e){return S[e]})).every((function(e){return v?e.machineChoice:e.userChoice}))){e=Object(r.a)(B[t]);break}}e.length?setTimeout((function(){var t;k(v?"\u0418\u0441\u043a\u0443\u0441\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442 \u043f\u043e\u0431\u0435\u0436\u0434\u0430\u0435\u0442!":"".concat(c.name," \u043f\u043e\u0431\u0435\u0436\u0434\u0430\u0435\u0442!"));var n=(localStorage.getItem("tttScore")||c.score).split(":").map((function(e){return+e}));S[e[0]].userChoice?n[0]++:n[1]++,localStorage.setItem("tttScore",n.join(":")),A(!0),W(!0),null===D||void 0===D||null===(t=D.current)||void 0===t||t.childNodes.forEach((function(t,c){t.classList.add(e.includes(c)?"animated":"nonAnimated")}))}),500):(S.filter((function(e){return e.disabled})).length===S.length&&setTimeout((function(){k("\u041d\u0438\u0447\u044c\u044f!"),A(!0)}),500),g(!v))};return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{className:"score",children:[Object(l.jsx)("table",{children:Object(l.jsxs)("tbody",{children:[Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{children:Object(l.jsx)("span",{children:c.name})}),Object(l.jsx)("th",{children:"AI"})]}),Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:L}),Object(l.jsx)("td",{children:P})]})]})}),Object(l.jsx)("button",{onClick:function(){localStorage.removeItem("tttScore"),window.location.reload()},children:"\u041e\u0431\u043d\u0443\u043b\u0438\u0442\u044c"})]}),Object(l.jsxs)("p",{children:["\u041a\u0430\u043a\u043e\u0435 \u0436\u0435 \u043f\u043e\u0440\u0442\u0444\u043e\u043b\u0438\u043e \u0431\u0435\u0437 \u043a\u0440\u0435\u0441\u0442\u0438\u043a\u043e\u0432-\u043d\u043e\u043b\u0438\u043a\u043e\u0432!",Object(l.jsx)("br",{})," \u041d\u0430 \u0431\u0430\u0437\u0435 \u044d\u0442\u043e\u0433\u043e ",Object(l.jsx)("a",{href:"http://www.bugi-verstki.ru/projects/tic-tac-toe/ttt.html",target:"_blank",children:"\u0432\u0430\u043d\u0438\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0442\u043e\u0442\u0438\u043f\u0430"}),"."]}),Object(l.jsx)("div",{ref:D,className:U?"deck disabled":"deck",children:S.map((function(e,t){return Object(l.jsx)("div",{onClick:function(t){return function(e,t){t.userChoice||t.machineChoice||(W(!0),C(S.map((function(e){return e.id===t.id?Object(s.a)(Object(s.a)({},e),{},{userChoice:!0,disabled:!0}):e}))))}(0,e)},style:{width:100/O+"%"},className:e.userChoice?"deck__cell x":e.machineChoice?"deck__cell o":e.animated?"deck__cell animated":"deck__cell",children:Object(l.jsx)("i",{})},t)}))}),E&&Object(l.jsxs)("div",{className:"reloadLink",children:[Object(l.jsx)("h3",{children:_}),Object(l.jsx)("span",{onClick:function(){window.location.reload()},children:"\u0418\u0433\u0440\u0430\u0442\u044c \u0441\u043d\u043e\u0432\u0430"})]}),Object(l.jsx)("span",{className:"openSettings",onClick:function(){return b(!0)}}),d&&Object(l.jsx)(j,{data:c,onCancel:function(){b(!1)},onSubmit:function(e){var t=e.name,n=e.width,i=e.starter;localStorage.setItem("tttUserName",t),a(Object(s.a)(Object(s.a)({},c),{},{name:t})),localStorage.setItem("tttWidth",n.toString()),a(Object(s.a)(Object(s.a)({},c),{},{width:n})),localStorage.setItem("tttStarter",i),a(Object(s.a)(Object(s.a)({},c),{},{starter:i})),window.location.reload()}})]})};i.a.render(Object(l.jsx)(u,{}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.00db0918.chunk.js.map